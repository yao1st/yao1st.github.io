---
title: 直流无刷电机BLDC-1
date: 2018-01-08 09:36:35
tags: -stm32
      -BLDC
categories: embedded
password:
visible:
---
## 一些介绍 ##

直流有刷电机依靠电刷实现磁场换向，由于触点滑动，存在电刷磨损、火花、发热量大等缺点。而BLDC则是依靠电路实现电子换向，也就没有了电刷带来的一系列问题。对应的代价则是驱动变得比较复杂。BDC与BLDC的另一点显著区别则是BDC一般是线圈做转子，而BLDC一般是永磁体做转子。BLDC可以看作是PMSM（永磁同步电机）的一种。BLDC可分为外转子和内转两种。

<img src="/images/bdc_bldc.png" width="45%">

另一类电机则是交流感应电机，与BLDC不同，交流感应电机的转子不是永磁体，二是闭合线圈，依靠定子线圈产生的变化磁场激发的反电动势进而产生自己的磁场。有种“大哥带小弟一起飞”的感觉，所以并不是同步的，这类电机是异步电机。交流感应异步电机在大功率高转速场合比较适合，在低速和精准调速方面不如BLDC。

BLDC在换向时需要知道转子的位置，因此需要测量或估计转子位置的方法。一般采用霍尔、编码器等传感器，或者依靠反电动势BEMF等无感方法来进行转子位置的估计。无感启动和对齐比较复杂。

## BLDC的工作原理 ##

BLDC的工作原理很简单，通过定子磁场不断变化，“吸引”转子永磁体和定子磁场一致“同步”

<!-- <img src="/images/bldc_work.gif"> -->
<img src="/images/bldc_work2.gif">
<!-- <iframe src="../images/bldc-work.gif"> -->

上面这个gif图片直观展现了单相驱动的原理，但是，BLDC多采用三相接入，如果每次只有一相通电充磁，利用率和输出转矩都太低。因此，可以采用两相通电，一相闲置的方法，一个“吸引”一个“排斥”使得永磁转子旋转。如下面这个gif所示。

<img src="/images/bldc_2phrase.gif">

按照这种驱动方式，A B C三相在6拍之后可以使得定子磁场旋转一周。这类驱动方法称为梯形波驱动。

<img src="/images/bldc_6phrase.png" width="45%">

当然，在实际应用时并不需要同时对两相进行开关控制，可以将ABC三相的自由端相连，构成**星连接**即可。(有的也会采用三角连接)

<img src="/images/bldc_connect.gif">

## 正弦波驱动 ##

梯形波驱动其实就是一个控制电子换向器换向的过程，采用梯形波驱动可以获得很大的RPM。但是梯形波驱动会造成换向时相电流和输出转矩产生脉动。

<img src="/images/bldc_pulse.png" width="45%">

这一现象主要是由于相电流（相电压）不连续导致的。为了获得平稳的输出，可以采用正弦波驱动的方式。对于星形接线来说，其实是要让A-B A-C B-C两相之间的电流以正弦变化，为此，单相需要输入马鞍形波形。

对于数字控制器来说，可以采用PWM调制的方式来实现指定波形的输出，其方法是将波形按时间轴平分，然后用等高的离散矩形波来代替，该矩形的面积要和正弦波对应部分的面积相等，然后将该矩形波输入一阶惯性环节，即可得到近似的指定波形。

<img src="/images/bldc_foc.png" width="45%">

受限于PWM调制的频率，采用正弦波驱动的BLDC转速相较梯形波较小。

## FOC ##

正弦波驱动是三相同时驱动（同时存在电流），而梯形波驱动在6拍中只有两相通电，第三相闲置，闲置的这一相可以用来测量反电动势，用于转子位置估计等。

对于无感驱动的BLDC来说，为了获得转子位置估计，即使采用正弦波，可能也需要在反电动势过零处进行一下测量，这时候其实是在正弦波中加了一个干扰，好的控制器会对这一点进行特殊处理。

其实，正弦驱动的方法已经涉及到了一般的PMSM的驱动方法。PMSM一般使用FOC算法进行驱动，STM32有专门的SDK。从STM32官方的介绍来看，常用的STM32芯片在运行FOC算法时CPU占用达到60%以上，可见正弦波驱动方式计算量还是比较大的。

<img src="/images/bldc_focfoc.png" width="45%">

## BLDC中的霍尔 ##

BLDC在控制时需要时刻知道转子的位置，一般采用比较经济的霍尔作为传感器。霍尔的原理这里不多讲。在BLDC中，霍尔一般按照60度或120度均布，对于安装的精度有很高的要求。

BLDC中霍尔一般是单极性数字霍尔，在转子的S极靠近时霍尔导通输出低电平，S远离时输出高电平。三相电机一般也采用三个霍尔，不同的安装角度输出的高低组合有所差异，根据霍尔高低组合可以大致确定转子所在的位置范围，但若要获得更精确的位置估计则需进一步处理。

<img src="/images/bldc_hall.png" width="45%">

